<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Planner Pro - Planlar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #4361ee;
            --success-color: #28a745;
            --bg-color: #f8f9fa;
            --text-color: #333;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--bg-color);
            color: var(--text-color);
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        header {
            background: var(--primary-color);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .back-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
        }
        
        section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .input-group input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .input-group button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .task-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            margin: 0.5rem 0;
            border-radius: 5px;
        }
        
        .task-item.completed {
            opacity: 0.6;
        }
        
        .task-item.completed .task-text {
            text-decoration: line-through;
        }
        
        .task-actions {
            margin-left: auto;
            display: flex;
            gap: 0.5rem;
        }
        
        .task-actions button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 3px;
        }
        
        .edit-btn:hover { background: #007bff; color: white; }
        .delete-btn:hover { background: #dc3545; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 style="margin: 0;">üìå Planlar</h1>
            <button onclick="window.location.href='index.html'" class="back-btn">‚Üê Ana Sayfa</button>
        </header>

        <section>
            <h2 id="selectedDate">Tarih Se√ßilmedi</h2>
            
            <div class="input-group">
                <input type="text" id="taskInput" placeholder="Yeni g√∂rev yaz...">
                <button id="addTaskBtn">Ekle</button>
            </div>
            
            <div id="taskList">
                <!-- G√∂revler buraya eklenecek -->
            </div>
            
            <div id="emptyState" style="text-align: center; color: #666; padding: 2rem;">
                Hen√ºz g√∂rev eklenmemi≈ü
            </div>
        </section>
    </div>

    <script>
        console.log('Planlar sayfasƒ± ba≈ülatƒ±lƒ±yor...');
        
        // URL'den tarihi al
        const urlParams = new URLSearchParams(window.location.search);
        const selectedDate = urlParams.get('date');
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Planlar sayfasƒ± DOM y√ºklendi');
            
            if (!selectedDate) {
                alert('Ge√ßersiz tarih! Ana sayfaya y√∂nlendiriliyorsunuz.');
                window.location.href = 'index.html';
                return;
            }
            
            // Elementleri bul
            const selectedDateElement = document.getElementById('selectedDate');
            const taskInput = document.getElementById('taskInput');
            const addTaskBtn = document.getElementById('addTaskBtn');
            const taskList = document.getElementById('taskList');
            const emptyState = document.getElementById('emptyState');
            
            // Tarihi g√∂ster
            selectedDateElement.textContent = formatDate(selectedDate);
            
            // G√∂revleri y√ºkle
            loadTasks();
            
            // G√∂rev ekleme
            addTaskBtn.addEventListener('click', addTask);
            taskInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addTask();
            });
            
            function addTask() {
                const taskText = taskInput.value.trim();
                if (!taskText) {
                    alert('L√ºtfen bir g√∂rev yazƒ±n!');
                    return;
                }
                
                const tasks = getTasks();
                const newTask = {
                    id: Date.now().toString(),
                    text: taskText,
                    completed: false,
                    createdAt: new Date().toISOString()
                };
                
                tasks.push(newTask);
                saveTasks(tasks);
                taskInput.value = '';
                loadTasks();
                
                console.log('G√∂rev eklendi:', newTask);
            }
            
            function loadTasks() {
                const tasks = getTasks();
                
                if (tasks.length === 0) {
                    taskList.style.display = 'none';
                    emptyState.style.display = 'block';
                    return;
                }
                
                taskList.style.display = 'block';
                emptyState.style.display = 'none';
                
                taskList.innerHTML = tasks.map(task => `
                    <div class="task-item ${task.completed ? 'completed' : ''}" data-id="${task.id}">
                        <input type="checkbox" ${task.completed ? 'checked' : ''} 
                               onchange="toggleTask('${task.id}')">
                        <span class="task-text">${task.text}</span>
                        <div class="task-actions">
                            <button class="edit-btn" onclick="editTask('${task.id}')">‚úèÔ∏è</button>
                            <button class="delete-btn" onclick="deleteTask('${task.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `).join('');
            }
            
            function getTasks() {
                try {
                    const allPlans = JSON.parse(localStorage.getItem('plannerDatePlans') || '{}');
                    return allPlans[selectedDate] || [];
                } catch (error) {
                    console.error('G√∂rev y√ºkleme hatasƒ±:', error);
                    return [];
                }
            }
            
            function saveTasks(tasks) {
                try {
                    const allPlans = JSON.parse(localStorage.getItem('plannerDatePlans') || '{}');
                    allPlans[selectedDate] = tasks;
                    localStorage.setItem('plannerDatePlans', JSON.stringify(allPlans));
                } catch (error) {
                    console.error('G√∂rev kaydetme hatasƒ±:', error);
                alert('G√∂rev kaydedilirken hata olu≈ütu!');
                }
            }
            
            function formatDate(dateString) {
                const date = new Date(dateString);
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                if (date.toDateString() === today.toDateString()) return 'Bug√ºn';
                if (date.toDateString() === tomorrow.toDateString()) return 'Yarƒ±n';
                
                return date.toLocaleDateString('tr-TR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
            
            console.log('Planlar sayfasƒ± ba≈ülatƒ±ldƒ±:', selectedDate);
        });
        
        // Global fonksiyonlar
        window.toggleTask = function(taskId) {
            const tasks = getTasks();
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveTasks(tasks);
                loadTasks();
            }
        };
        
        window.editTask = function(taskId) {
            const tasks = getTasks();
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                const newText = prompt('G√∂revi d√ºzenleyin:', task.text);
                if (newText !== null && newText.trim() !== '') {
                    task.text = newText.trim();
                    saveTasks(tasks);
                    loadTasks();
                }
            }
        };
        
        window.deleteTask = function(taskId) {
            if (confirm('Bu g√∂revi silmek istediƒüinizden emin misiniz?')) {
                const tasks = getTasks().filter(t => t.id !== taskId);
                saveTasks(tasks);
                loadTasks();
            }
        };
        
        // Yardƒ±mcƒ± fonksiyonlarƒ± global yap
        window.getTasks = function() {
            try {
                const allPlans = JSON.parse(localStorage.getItem('plannerDatePlans') || '{}');
                return allPlans[selectedDate] || [];
            } catch (error) {
                console.error('G√∂rev y√ºkleme hatasƒ±:', error);
                return [];
            }
        };
        
        window.saveTasks = function(tasks) {
            try {
                const allPlans = JSON.parse(localStorage.getItem('plannerDatePlans') || '{}');
                allPlans[selectedDate] = tasks;
                localStorage.setItem('plannerDatePlans', JSON.stringify(allPlans));
            } catch (error) {
                console.error('G√∂rev kaydetme hatasƒ±:', error);
                alert('G√∂rev kaydedilirken hata olu≈ütu!');
            }
        };
        
        // Global hata yakalama
        window.addEventListener('error', function(e) {
            console.error('Global hata:', e.error);
        });
    </script>
</body>
</html>